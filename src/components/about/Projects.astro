---
import { getCollection } from "astro:content";
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import SectionTitle from "./SectionTitle.astro";

const lang = getLangFromUrl(Astro.url) as "en" | "es";
const t = useTranslations(lang);

const projects = await getCollection(
  lang === "en" ? "projectsEn" : "projectsEs"
);
---

<div class="space-y-6 md:space-y-8">
  <SectionTitle title={t("about.projects.title")} />
  <div class="flex flex-col gap-6 md:gap-8">
    {
      projects.map((project) => (
        <div class="card card-side bg-base-100 shadow-sm hover:shadow-md transition-shadow duration-300">
          {project.data.imageName ? (
            <figure class="w-2/3 max-w-xs">
              <img
                src={`/assets/projects/${project.data.imageName}.png`}
                alt={project.data.title}
                class="h-full object-cover"
              />
            </figure>
          ) : (
            <figure class="bg-gradient-to-r from-base-content to-base-300 w-1/3 max-w-xs" />
          )}
          <div class="card-body">
            <h2 class="card-title font-playfair">{project.data.title}</h2>
            <p class="font-inter">{project.data.description}</p>
            <div class="card-actions justify-end">
              {project.data.tags &&
                project.data.tags.map((tag: string) => (
                  <div class="badge badge-outline text-primary">{tag}</div>
                ))}
              <a
                href={`/${lang}/projects/${project.id}`}
                class="btn btn-primary"
              >
                {t("about.projects.viewProject")}
              </a>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</div>
