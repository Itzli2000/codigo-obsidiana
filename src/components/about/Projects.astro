---
import { getCollection } from "astro:content";
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import SectionTitle from "./SectionTitle.astro";
import { CDN, TYPE } from "../../constants/cdn";

const lang = getLangFromUrl(Astro.url) as "en" | "es";
const t = useTranslations(lang);

const projects = await getCollection(
  lang === "en" ? "projectsEn" : "projectsEs"
);
---

<div class="space-y-6 md:space-y-8">
  <SectionTitle title={t("about.projects.title")} />
  <div class="flex flex-col gap-6 md:gap-8">
    {
      projects.map((project) => (
        <div class="card bg-base-100 shadow-sm hover:shadow-md transition-shadow duration-300 flex-col md:card-side">
          {project.data.image ? (
            <figure class="w-full md:w-2/3 md:max-w-xs">
              <img
                src={`${CDN.IMAGES}${TYPE.PROJECT}${project.data.image}`}
                alt={project.data.title}
                class="h-full object-cover"
              />
            </figure>
          ) : (
            <figure class="bg-gradient-to-r from-base-content to-base-300 w-full md:w-1/3 md:max-w-xs" />
          )}
          <div class="card-body">
            <h2 class="card-title">{project.data.title}</h2>
            <p>{project.data.description}</p>
            <div class="flex flex-wrap gap-2 my-2">
              {project.data.tags &&
                project.data.tags.map((tag: string) => (
                  <div class="badge badge-sm badge-outline text-primary">{tag}</div>
                ))}
            </div>
            <div class="card-actions justify-end">
              <a
                href={`/${lang}/projects/${project.id}`}
                class="btn btn-primary"
              >
                {t("about.projects.viewProject")}
              </a>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</div>
